<div class="container-fluid">

    <ng-template #foodNutritionDataModal let-modal>
        <div class="modal-header">
            <h4 class="modal-title" id="modal-basic-title">Nutrition Info per 100 grams</h4>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <form #createFoodForm="ngForm">
                <h1 class="text-center font-weight-light">{{selectedFoodForModal.description}}</h1>


                <h3 class="text-center font-weight-light">Calories: {{selectedFoodForModal.calories}}</h3>
                <div class="chart-container row align-middle">
                    <ngx-charts-pie-chart
                            [results]="macroNutrientsData"
                            [animations]="true"
                            [trimLabels]="false"
                            [doughnut]="true"
                    >

                    </ngx-charts-pie-chart>

                    <div class="macros text-center mx-auto">
                        <h5 class="font-weight-light ">
                            Protein: {{this.selectedFoodForModal.proteinPerHundred}}g.</h5>
                        <h5 class="font-weight-light ">
                            Carbohydrates: {{this.selectedFoodForModal.carbohydratesPerHundred}}g.</h5>
                        <h5 class="font-weight-light ">Fats: {{this.selectedFoodForModal.fatsPerHundred}}
                            g.</h5>
                        <span class="display-5 opacity-5"><i
                                class="fas fa-utensils fa-lg"></i></span>
                    </div>

                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-outline-dark" (click)="modal.dismiss()">Close</button>
        </div>
    </ng-template>

    <div class="jumbotron">
        <div class="container">

            <img src="assets/static/images/logo.png" height="300px" class="align-center" alt="">
            <h1 class="display-4">Search Food in USDA FoodData Central</h1>
        </div>

        <hr/>

        <div class="row justify-content-center">
            <div class="col-6">
                <form class="card card-sm">
                    <div class="card-body row no-gutters align-items-center">
                        <div class="col-lg-1">
                            <label for="searchInput"><i class="fas fa-search fa-2x"></i></label>

                        </div>
                        <div class="col-lg-9">
                            <form #searchForm="ngForm"></form>
                            <input class="form-control form-control-lg form-control-borderless" id="searchInput"
                                   type="search"
                                   placeholder="Enter food name"
                                   #inputSearch="ngModel"
                                   name="foodName"
                                   required
                                   [ngClass]="{'is-valid': inputSearch.valid && inputSearch.touched, 'is-invalid': inputSearch.invalid && inputSearch.touched}"
                                   [(ngModel)]="searchFoodName">
                        </div>
                        <div class="col-lg-2">
                            <button class="btn btn-lg btn-success" [disabled]="searchForm.invalid" type="submit"
                                    (click)="onSearchHandler()">Search
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>


        <hr class="my-4">
        <div class="container justify-content-center pb-0">
            <ng-template [ngIf]="foodSearchResults.length > 0" [ngIfElse]="noSuchFoods">


                <div class="results-container col-10 mx-auto py-2">
                    <h2 class="font-weight-bold text-center py-4">Search Food Results</h2>
                    <table class="table table-striped table-hover mb-4">
                        <thead>
                        <tr>
                            <th scope="col" style="width: 10%">Order</th>
                            <th scope="col" style="width: 50%">Description</th>
                            <th scope="col" style="width: 40%">Actions</th>

                        </tr>
                        </thead>
                        <tbody>

                        <tr *ngFor="let food of foodSearchResults| slice: (page-1) * pageSize : (page-1) * pageSize + pageSize; let i = index">
                            <td class="align-middle">{{i + 1 + (page - 1) * pageSize}}</td>
                            <td class="align-middle">{{food.description}}</td>
                            <td>
                                <button type="button"
                                        class="btn btn-secondary mr-2" (click)="open(foodNutritionDataModal, food.id)">
                                    Nutrition Info
                                </button>
                                <button type="button"
                                        class="btn btn-primary mr-2">Create Food
                                </button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <ngb-pagination class="d-inline-block mt-5" [(page)]="page"
                                [pageSize]="pageSize"
                                [collectionSize]="foodSearchResults.length"></ngb-pagination>
            </ng-template>

            <ng-template #noSuchFoods>
                <h5>There are no foods with given name.</h5>
            </ng-template>

        </div>


    </div>


</div>
